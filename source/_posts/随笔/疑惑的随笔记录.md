---
title: '疑惑的随笔记录'
date: 2018-4-18 22:17:00
tags:
---


1、跨域
> 只要协议、域名、端口有任何一个不同，都被当作是不同的域，之间的请求就是跨域操作。

[知乎关于跨域的回答](https://www.zhihu.com/question/26376773)

CSRF-跨站请求伪造
防御手段：

1、检查Referer字段

2、添加校验token，通过页面上表单的某一项，附加在表单中，内容为伪乱数，作为验证。


协程（纤程）Fiber
协程概念：一种用户态的轻量级线程，其实就是单线程，指定执行整个函数中到一部分然后就先出去执行别的，等条件满足时，协程下次更新帧到了再继续往下执行。优点是无需线程上下文切换的开销，充分开发了单CPU的能力，资源占用低，适合高并发I/O。缺点也很明显，就是没办法利用多CPU的优势。
框架：Quasar，调度器使用ForkJoinPool来调度这些fiber。Fiber调度器FiberScheduler是一个高效的、work-stealing、多线程的调度器。
场景：服务A平时需要调用其他服务，但其他服务在并发高的时候延迟很严重。 
一开始可以用httpClient连接池+线程池来处理，但如果调用服务的时候延迟太高或者超时，则会导致服务A的吞吐量会特别差。原因主要是一般一个链接由一个线程来处理，是阻塞的，所以在线程池数有限的情况下，吞吐量肯定上不去。并且当所有线程都I/O阻塞的时候，会很浪费CPU资源，并且CPU会一直做无用的上下文切换。
这时候可以考虑协程来替换。
yeild resume 

网站优化方法
减少http请求-图片地图，合并图片，内联图片，合并脚本与样式表
内容发布网络（CDN）
使用Expires缓存，持久化。
压缩组件
动态内容静态化
优化数据库
使用负载均衡技术
使用缓存
后端优化：编译器选项，数据库索引，内存管理